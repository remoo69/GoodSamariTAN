{% extends 'landingPage.html' %}
{% load static %}

{% block content %}
  {% include 'nav.html' %}

  <div class="max-w-3xl mx-auto mt-10 px-4 sm:px-6 lg:px-8 mb-20">
    <h1 class="text-3xl font-bold text-slate-800 mb-6">Donation form</h1>
    <form id="donationForm" method="POST" enctype="multipart/form-data" class="bg-white p-6 rounded-md shadow-md">
      {% csrf_token %}

      <!-- Name & Contact -->
      <div class="mb-4">
        <div>
          <label for="name" class="block text-sm font-medium text-gray-700">Name <span class="text-red-500">*</span></label>
          <input type="text" name="name" id="name" class="w-full mt-2 px-4 py-2 border rounded-md" pattern="[A-Za-z .]+" title="Only letters and spaces are allowed" required />
        </div>
        <div>
          <label for="phone" class="block text-sm font-medium text-gray-700">Phone <span class="text-red-500">*</span></label>
          <input type="tel" name="phone" id="phone" class="w-full mt-2 px-4 py-2 border rounded-md" pattern="\d+" title="Phone number must contain only numbers" required />
        </div>
      </div>

      <!-- Email -->
      <div>
        <label for="email" class="block text-sm font-medium text-gray-700">Email <span class="text-red-500">*</span></label>
        <input type="email" name="email" id="email" class="w-full mt-2 px-4 py-2 border rounded-md" required />
      </div>

      <!-- Item Details -->
      <div class="mb-4">
        <div>
          <label for="item" class="block text-sm font-medium text-gray-700">Item <span class="text-red-500">*</span></label>
          <input type="text" name="item" id="item" class="w-full mt-2 px-4 py-2 border rounded-md" required />
        </div>
        <div>
          <label for="quantity" class="block text-sm font-medium text-gray-700">Quantity <span class="text-red-500">*</span></label>
          <input type="number" name="quantity" id="quantity" class="w-full mt-2 px-4 py-2 border rounded-md" required />
        </div>
      </div>

      <!-- Dimensions -->
      <div class="grid sm:grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label for="height" class="block text-sm font-medium text-gray-700">Height (IN)</label>
          <input type="number" name="height" id="height" class="w-full mt-2 px-4 py-2 border rounded-md" />
        </div>
        <div>
          <label for="width" class="block text-sm font-medium text-gray-700">Width (IN)</label>
          <input type="number" name="width" id="width" class="w-full mt-2 px-4 py-2 border rounded-md" />
        </div>
        <div>
          <label for="weight" class="block text-sm font-medium text-gray-700">Weight (KG)</label>
          <input type="number" name="weight" id="weight" class="w-full mt-2 px-4 py-2 border rounded-md" />
        </div>
      </div>

      <!-- Category & Description -->
      <div class="mb-4">
        <div>
          <label for="category" class="block text-sm font-medium text-gray-700">Category</label>
          <input type="text" name="category" id="category" class="w-full mt-2 px-4 py-2 border rounded-md" />
        </div>
        <div>
          <label for="description" class="block text-sm font-medium text-gray-700">Description</label>
          <textarea name="description" id="description" rows="2" class="w-full mt-2 px-4 py-2 border rounded-md"></textarea>
        </div>
      </div>

      <!-- Image & Notes -->
      <div class="mb-4">
        <div>
          <label for="image" class="block text-sm font-medium text-gray-700">Upload Image</label>
          <input type="file" name="image" id="image" class="w-full mt-2 px-4 py-2 border rounded-md" />
        </div>
        <div>
          <label for="notes" class="block text-sm font-medium text-gray-700">Notes</label>
          <textarea name="notes" id="notes" rows="2" class="w-full mt-2 px-4 py-2 border rounded-md"></textarea>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="w-full sm:w-auto px-5 py-2 bg-slate-500 text-white rounded-md hover:bg-slate-600">Submit Application</button>
    </form>
  </div>

  <!-- JavaScript -->
  <script>
    const form = document.getElementById('donationForm')
    form.addEventListener('submit', function (event) {
      event.preventDefault() // Prevent default form submission
    
      const formData = new FormData(form)
    
      fetch('{% url "donation_form" %}', {
        // Replace with the correct URL name
        method: 'POST',
        body: formData
      })
        .then((response) => response.json())
        .then((data) => {
          if (data.success) {
            alert('Donation successfully submitted!')
            document.getElementById('donationModal').classList.add('hidden')
          } else {
            alert('There was an error submitting the form.')
          }
        })
        .catch((error) => {
          console.error('Error:', error)
          alert('An unexpected error occurred.')
        })
    })
  </script>

  {% include 'footer.html' %}
{% endblock %}
